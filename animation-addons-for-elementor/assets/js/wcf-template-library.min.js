!function(e,t,a,n){let r,i=1,l="",o="",c="",s=0;(async()=>{await fetch("https://block.animation-addons.com/wp-json/templates/v2/wcf-tpl-category").then((e=>e.json())).then((e=>{r=e}))})();let m="https://block.animation-addons.com/wp-json/wp/v2/wcf-templates?page=1&per_page=100&subtype=block";const d=function(e){let t=[];return e.forEach(((e,a)=>{WCF_TEMPLATE_LIBRARY?.config?.wcf_valid&&!0===WCF_TEMPLATE_LIBRARY?.config?.wcf_valid&&(e.valid="yes"),t.push(e)})),t.reverse()},u=async function(e="",t,a=1,n=""){let r=[],l=new URL(m);t&&l.searchParams.set("subtype",t),e&&""!==e&&l.searchParams.set("cat",e),a&&(l.searchParams.set("page",a),i=a),n&&l.searchParams.set("color_type",n);try{const e=await fetch(l);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);r=(await e.json()).templates||[]}catch(e){console.error("Fetch Error:",e)}return d(r)};e("document").ready((function(){let n=e("#tmpl-elementor-add-section");if(0<n.length){var f=n.html();f=f.replace('<div class="elementor-add-section-drag-title','<div class="elementor-add-section-area-button elementor-add-wcf-template-button"></div><div class="elementor-add-section-drag-title'),n.html(f)}elementor.on("preview:loaded",(function(){e(elementor.$previewContents[0].body).on("click",".elementor-add-wcf-template-button",(function(n){async function f(n,m,d="",f=""){let h=wp.template("wcf-templates");contents=null;let w=!0;b(w),contents=await h({templates:[],categories:r}),n.append(contents);const y=a.querySelector(".wcf-library-templates");l=d,o=m,c=f,0===s&&(e(t).trigger("resize"),s++);(await u(d,m,1,f)).forEach((e=>{const t=p(e);y&&(y.innerHTML+=t)})),function(){const e=a.querySelectorAll(".aaeaadon-loadmore-footer");if(!e||!e.length)return;const t=e[e.length-1],n={root:null,rootMargin:"0px",threshold:.1},r=(e,t)=>{e.forEach((async e=>{if(e.isIntersecting){let e=await u(l,o,i+1,c);const t=a.querySelector(".wcf-library-templates");e&&e.forEach((e=>{const a=p(e);t.innerHTML+=a}))}}))};new IntersectionObserver(function(e,t=300){let a=null;return(...n)=>new Promise(((r,i)=>{a&&clearTimeout(a),a=setTimeout((async()=>{try{const t=await e(...n);r(t)}catch(e){i(e)}}),t)}))}(r),n).observe(t)}(),e(e(".wcf-library-template").last()).find("img").on("load",(function(){w=!1,b(w),e(t).trigger("resize")})),d&&e("#wcf-template-library-filter-subtype option[value='"+d+"']").attr("selected","selected"),f&&e("#wcf-template-library-color-subtype option[value='"+f+"']").attr("selected","selected")}function h(a){0;const n=e(".wcf-template-library--header .elementor-template-library-menu-item");n.click((function(){e(this).hasClass("elementor-active")||(n.removeClass("elementor-active"),e(this).addClass("elementor-active"),r=e(this).attr("data-tab"),e(a).find(".dialog-message").remove(),f(a,r))})),e(".elementor-templates-modal__header__close").on("click",(function(){t.wcftmLibrary.hide()}));let r=e(".wcf-template-library--header .elementor-active").attr("data-tab");f(a,r)}function w(n=null){let r=!0;e(a).on("click",".library--action.insert",(function(){let a=e(this),i=n;null===i&&(i=e(this).closest(".wcf-library-template").data("id")),b(r),a.hide(),t.wcftmLibrary.currentRequest=elementorCommon.ajax.addRequest("get_wcf_template_data",{unique_id:i,data:{edit_mode:!0,display:!0,template_id:i},success:function(e){$e.run("document/elements/import",{model:t.elementor.elementsModel,data:e}),r=!1,t.wcftmLibrary.hide()}}).fail((function(){}))}))}function b(t){let a=e(".wcf-template-library--loading");t?(a.show(),a.removeAttr("hidden")):(a.hide(),a.attr("hidden"))}n.preventDefault(),t.wcftmLibrary=elementorCommon.dialogsManager.createWidget("lightbox",{id:"wcf-template-library",onShow:function(){this.getElements("widget").addClass("elementor-templates-modal"),this.getElements("header").remove(),this.getElements("message").remove(),this.getElements("buttonsWrapper").remove(),function(n){let r=wp.template("wcf-templates-header");content=null,content=r({template_types:WCF_TEMPLATE_LIBRARY.template_types}),n.html(content),h(n),function(t){e(a).on("change","#wcf-template-library-filter-subtype",(function(a){let n=e(".wcf-template-library--header .elementor-active").attr("data-tab"),r=this.value;e(t).find(".dialog-message").remove(),f(t,n,r,c),w()}))}(n),function(t){e(a).on("change","#wcf-template-library-color-subtype",(function(a){let n=e(".wcf-template-library--header .elementor-active").attr("data-tab"),r=this.value;e(t).find(".dialog-message").remove(),f(t,n,l,r),w()}))}(n),function(n){const r=e("#wcf-template-library .dialog-widget-content").html();e(a).on("click",".thumbnail",(function(){let t=e(this);const a=t.closest(".wcf-library-template").data("id"),r=t.closest(".wcf-library-template").data("url");let i=wp.template("wcf-templates-single");content_single=null,content_single=i({template_link:r}),n.html(content_single);let l=!0;b(l),e("#wcf-template-library iframe").on("load",(function(){l=!1,b(l)})),w(a)})),e(a).off("click","#wcf-template-library-header-preview-back"),e(a).on("click","#wcf-template-library-header-preview-back",(function(){e("#wcf-template-library .dialog-widget-content").html(r),b(!1),h(n)})),e(a).on("click",".elementor-templates-modal__header__close",(function(){t.wcftmLibrary.hide()}))}(n),function(){function t(e,t){let a;return function(...n){clearTimeout(a),a=setTimeout((()=>e.apply(this,n)),t)}}e(a).on("keyup","#wcf-template-library-filter-text",t((async function(){const t=this.value.toLowerCase(),n=a.querySelector(".wcf-library-templates"),r=await async function(t=""){let a=e("#elementor-template-library-header-menu .elementor-active").attr("data-tab")||"block",n=[],r=new URL(m);a&&r.searchParams.set("subtype",a),t&&""!==t&&r.searchParams.set("s",t);const i=e("wcf-template-library-filter-subtype").val();i&&""!==i&&r.searchParams.set("cat",i);try{const e=await fetch(r);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);n=(await e.json()).templates||[]}catch(e){console.error("Fetch Error:",e)}return d(n)}(t);n.innerHTML="",r.forEach((e=>{const t=p(e);n.innerHTML+=t})),setTimeout((()=>{const a=e(".wcf-library-template"),n=new RegExp(t,"i");a.each(((t,a)=>{const r=e(a).find(".title")[0];n.test(r.textContent)&&(r.innerHTML=r.textContent.replace(n,"<b>$&</b>"))}))}),100)}),300))}(),w()}(this.getElements("widgetContent"))},onHide:function(){t.wcftmLibrary.destroy()}}),t.wcftmLibrary.getElements("header").remove(),t.wcftmLibrary.show(),e(t).trigger("resize")}))}))})),e(a).on("click",".aaeplugin-activate",(function(e){e.preventDefault(),confirm("Are you sure you want to activate plugin? Any unsaved changes will be lost. Please Save change.")&&(async()=>{await fetch(WCF_TEMPLATE_LIBRARY.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({action:"activate_from_editor_plugin",action_base:"animation-addons-for-elementor-pro/animation-addons-for-elementor-pro.php",nonce:WCF_TEMPLATE_LIBRARY.nonce})}).then((e=>e.json())).then((e=>{e?.success&&t.location.reload()}))})()}));const p=e=>`\n            <div class="wcf-library-template" data-id="${e.id}" data-url="${e.template_demo_url}">\n                <div class="thumbnail">\n                    <img src="${e?.preview?.url}" alt="${e.title}">\n                </div>\n                \n                ${e?.valid&&e.valid?'\n                    \x3c!-- Show the \'Insert\' button if the template is valid --\x3e\n                    <button class="library--action insert">\n                        <i class="eicon-file-download"></i>\n                        Insert\n                    </button>\n                ':`\n                    \x3c!-- Show premium or activation buttons based on plugin status --\x3e\n                    ${WCF_TEMPLATE_LIBRARY?.pro_installed?"":'\n                        \x3c!-- Show \'Go Premium\' button if the plugin is not installed --\x3e\n                        <a href="https://animation-addons.com" class="library--action pro" target="_blank">\n                            <i class="eicon-external-link-square"></i>\n                            Go Premium\n                        </a>\n                    '}\n                    ${WCF_TEMPLATE_LIBRARY?.pro_installed&&WCF_TEMPLATE_LIBRARY?.pro_active&&!WCF_TEMPLATE_LIBRARY?.config?.wcf_valid?`\n                        \x3c!-- Show 'Pro' button if the plugin is installed and active --\x3e\n                        <a href="${WCF_TEMPLATE_LIBRARY.dashboard_link}" class="library--action pro" target="_blank">\n                            <i class="eicon-external-link-square"></i>\n                            Activate License\n                        </a>\n                    `:""}\n                    ${WCF_TEMPLATE_LIBRARY?.pro_installed&&!WCF_TEMPLATE_LIBRARY?.pro_active?'\n                        \x3c!-- Show \'Activate\' button if the plugin is installed but not active --\x3e\n                        <button class="library--action pro aaeplugin-activate">\n                            <i class="eicon-external-link-square"></i>\n                            Activate\n                        </button>\n                    ':""}\n                `}\n                \n                <p class="title">${e.title}</p>\n            </div>\n        `}(jQuery,window,document);