!function(e){"use strict";const a={instance:[],templateId:0,init:function(){this.renderPopup(),this.reinitSelect2(),e(document).on("click","#wcf-addons-archive-display-type",this.specificsDisplay),e("body.post-type-wcf-addons-template #wpcontent").on("click",".page-title-action, .row-title, .row-actions .edit > a",this.openPopup),e(document).on("click",".wcf-addons-body-overlay,.wcf-addons-template-edit-cross",this.closePopup).on("click",".wcf-addons-tmp-save",this.savePost).on("click",".wcf-addons-tmp-elementor",this.redirectEditPage).on("wcf_template_edit_popup_open",this.displayLocation).on("change","#wcf-addons-template-type, #wcf-addons-hf-display-type",this.displayLocation),e(document).on("change","#wcf-addons--popup--builder-trigger",this.triggerChange),e(document).on("change","#aae-header-smoother-location",this.SmootherChange),e("#wcf-addons-hf-s-display-type").on("select2:select",function(a){var t=e(this).val(),o=[...new Set(t)];e(this).val(o).trigger("change")})},specificsDisplay:function(a){a.preventDefault(),"specifics_cat"==e(this).val()?e(".single-category-location").removeClass("hidden"):e(".single-category-location").addClass("hidden")},reinitSelect2:function(){e("#wcf-addons-hf-s-display-type").select2({ajax:{url:ajaxurl,dataType:"json",method:"post",delay:250,data:function(e){return{q:e.term,page:e.page||1,action:"wcf_get_posts_by_query",nonce:WCF_Theme_Builder.nonce}},processResults:function(e){let a=[],t=new Set;return e.forEach(e=>{t.has(e.id)||(t.add(e.id),a.push(e))}),{results:a}},cache:!0},minimumInputLength:2,placeholder:"Search and select an option",allowClear:!0})},renderPopup:function(a){var t;t=wp.template("wcf-addons-ctppopup")({templatetype:WCF_Theme_Builder.templatetype,hflocation:WCF_Theme_Builder.hflocation,archivelocation:WCF_Theme_Builder.archivelocation,singlelocation:WCF_Theme_Builder.singlelocation,postcategory:WCF_Theme_Builder.postcategory,editor:WCF_Theme_Builder.editor,heading:WCF_Theme_Builder.labels}),e("body").append(t)},triggerChange:function(t){t.preventDefault();const o=e(this).val();a.selectorFieldDisplay(o)},SmootherChange:function(a){a.preventDefault();"no"===e(this).val()?e(".aae-header-smoother-location.yoffset").removeClass("hidden"):e(".aae-header-smoother-location.yoffset").addClass("hidden")},selectorFieldDisplay:function(a){["page_scroll"].includes(a)?e("#aae-popup-builder-scrollPostion").parents(".aae-popup-builder-location").removeClass("hidden"):e("#aae-popup-builder-scrollPostion").parents(".aae-popup-builder-location").addClass("hidden"),["click"].includes(a)?e("#aae-popup-builder-selector").parents(".aae-popup-builder-location").removeClass("hidden"):e("#aae-popup-builder-selector").parents(".aae-popup-builder-location").addClass("hidden")},openPopup:function(t){t.preventDefault();let o=e(this).closest("tr").attr("id"),d=null,l=null;o&&(d=o.replace("post-",""),l="post.php?post="+d+"&action=elementor"),e(".wcf-addons-tmp-save").attr("data-tmpid",d),e(".wcf-addons-tmp-elementor").attr({"data-link":l,"data-tmpid":d}),d?e.ajax({url:WCF_Theme_Builder.ajaxurl,data:{action:"wcf_get_template",nonce:WCF_Theme_Builder.nonce,tmpId:d},type:"POST",beforeSend:function(){},success:function(a){document.querySelector("#wcf-addons-template-type option[value='"+a.data.tmpType+"']").selected="true",e("#wcf-addons-template-title").attr("value",a.data.tmpTitle),e(".wcf-addons-tmp-elementor").removeClass("disabled").removeAttr("disabled","disabled")},complete:function(t){if(e("#wcf-addons-hf-s-display-type").val(null).trigger("change"),e(document).trigger("wcf_template_edit_popup_open"),"specifics_cat"===t.responseJSON.data.tmpLocation){e(".single-category-location").removeClass("hidden");let a=Object.keys(t.responseJSON.data.tmpSpLocation);e("#wcf-addons-single-category-display-type").find("option[value='"+a[0]+"']").length&&(e("#wcf-addons-single-category-display-type").find("option[value='"+a[0]+"']")[0].selected="true",e("#wcf-addons-single-category-display-type").trigger("change"))}else e(".single-category-location").addClass("hidden");e(".hf-location:visible select, .archive-location:visible select, .single-location:visible select").find("option[value='"+t.responseJSON.data.tmpLocation+"']")[0].selected="true",t.responseJSON.data.tmpSpLocation&&(e.each(t.responseJSON.data.tmpSpLocation,function(a,t){let o={id:a,text:t},d=new Option(o.text,o.id,!0,!0);e("#wcf-addons-hf-s-display-type").append(d).trigger("change")}),t.responseJSON.data.tmpType&&"header"===t.responseJSON.data.tmpType?(e(".aae-header-smoother-location").removeClass("hidden"),e("#aae-header-smoother-location").val(t.responseJSON.data.tmpHeaderSmoother),e("#aae-header-smoother-yoffset").val(t.responseJSON.data.tmpHeaderSmootherOffsetY),"no"!==t.responseJSON.data.tmpHeaderSmoother&&e(".aae-header-smoother-location.yoffset").addClass("hidden")):e(".aae-header-smoother-location").addClass("hidden"),t.responseJSON.data.tmpType&&"popup"===t.responseJSON.data.tmpType?(e("#aae-popup-builder-delay").val(t.responseJSON.data.tmpDelay),e("#aae-popup-builder-selector").val(t.responseJSON.data.tmpSelector),e("#aae-popup-builder-scrollPostion").val(t.responseJSON.data?.tmpScrollPostion),e("#wcf-addons--popup--builder-trigger").val(t.responseJSON.data?.tmpTrigger).trigger("change"),e("#wcf-addons--popup--builder-effect").val(t.responseJSON.data?.tmpEffect).trigger("change"),e(".aae-popup-builder-location").removeClass("hidden"),a.selectorFieldDisplay(t.responseJSON.data?.tmpTrigger)):e(".aae-popup-builder-location").addClass("hidden")),e(".wcf-addons-template-edit-popup-area").addClass("open-popup")},error:function(e){console.log(e)}}):(e(document).trigger("wcf_template_edit_popup_open"),e(".wcf-addons-tmp-elementor").addClass("button disabled").attr("disabled","disabled"),e(".wcf-addons-template-edit-popup-area").addClass("open-popup"),a.getParam("template_type")&&e("#wcf-addons-template-type").val(a.getParam("template_type")).trigger("change"))},getParam:function(e,a=window.location.href){return new URL(a).searchParams.get(e)},closePopup:function(t){e(".wcf-addons-template-edit-popup-area").removeClass("open-popup"),e("#wcf-addons-hf-s-display-type").select2("destroy");e(".wcf-addons-template-edit-field.hf-s-location").html('<label class="wcf-addons-template-edit-label"></label>\n                                <select class="wcf-addons-template-edit-input" name="wcf-addons-hf-s-display-type[]"\n                                        id="wcf-addons-hf-s-display-type" multiple="multiple">\n                                </select>'),a.reinitSelect2()},savePost:function(a){const t=e(this),o=a.target.dataset.tmpid?a.target.dataset.tmpid:"",d=e("#wcf-addons-template-title").val(),l=e("#wcf-addons-template-type").val(),s=e(".hf-location:visible select, .archive-location:visible select, .single-location:visible select").val();let i=e(".hf-s-location:visible select").val();"specifics_cat"==s&&(i=[],i.push(e("#wcf-addons-single-category-display-type").val()));let n={action:"wcf_save_template",nonce:WCF_Theme_Builder.nonce,tmpId:o,title:d,tmpType:l,tmpDisplay:s,specificsDisplay:JSON.stringify(i)??null};"popup"===l&&(n.tmpDelay=e("#aae-popup-builder-delay").val()?e("#aae-popup-builder-delay").val():0,n.tmpTrigger=e("#wcf-addons--popup--builder-trigger").val()?e("#wcf-addons--popup--builder-trigger").val():"pageloaded",n.tmpEffect=e("#wcf-addons--popup--builder-effect").val()?e("#wcf-addons--popup--builder-effect").val():"flip",n.tmpSelector=e("#aae-popup-builder-selector").val()?e("#aae-popup-builder-selector").val():"",n.tmpScrollPostion=e("#aae-popup-builder-scrollPostion").val()?e("#aae-popup-builder-scrollPostion").val():0),"header"===l&&(n.tmpHeaderSmoother=e("#aae-header-smoother-location").val()?e("#aae-header-smoother-location").val():"",n.tmpHeaderSmootherOffsetY=e("#aae-header-smoother-yoffset").val()?e("#aae-header-smoother-yoffset").val():""),e.ajax({url:WCF_Theme_Builder.ajaxurl,data:n,type:"POST",beforeSend:function(){t.text(WCF_Theme_Builder.labels.buttons.save.saving),t.addClass("updating-message")},success:function(a){if(""==o){if(a.data.id)var t="post.php?post="+a.data.id+"&action=elementor";e(".wcf-addons-tmp-save").attr("data-tmpid",a.data.id),e(".wcf-addons-tmp-elementor").attr({"data-link":t,"data-tmpid":a.data.id}),e(".wcf-addons-tmp-elementor").removeClass("disabled").removeAttr("disabled","disabled")}},complete:function(a){e("body.post-type-woolentor-template").removeClass("loading"),t.removeClass("updating-message"),t.text(WCF_Theme_Builder.labels.buttons.save.saved)},error:function(e){console.log(e)}})},redirectEditPage:function(a){a.preventDefault();var t=e(this),o=t.data("link")?t.data("link"):"";window.location.replace(WCF_Theme_Builder.adminURL+o)},displayLocation:function(a){let t=e("#wcf-addons-template-type").val();e(".hf-s-location").addClass("hidden"),"archive"===t?(e(".archive-location").removeClass("hidden"),e(".hf-location, .single-location").addClass("hidden")):"single"===t?(e(".single-location").removeClass("hidden"),e(".hf-location, .archive-location").addClass("hidden")):(e(".hf-location").removeClass("hidden"),e(".single-location, .archive-location").addClass("hidden"),setTimeout(function(){"specifics"===e("#wcf-addons-hf-display-type").val()&&e(".hf-s-location").removeClass("hidden")},100)),"popup"===t?e(".aae-popup-builder-location").removeClass("hidden"):e(".aae-popup-builder-location").addClass("hidden"),"header"===t?e(".aae-header-smoother-location").removeClass("hidden"):e(".aae-header-smoother-location").addClass("hidden")}};a.init()}(jQuery);